{"version":3,"file":"VaTimePickerColumn.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../../../src/components/va-time-picker/components/VaTimePickerColumn/VaTimePickerColumn.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"rootElement\"\n    tabindex=\"0\"\n    class=\"va-time-picker-column\"\n    @keydown.down.stop.prevent=\"makeActiveNext()\"\n    @keydown.space.stop.prevent=\"makeActiveNext(5)\"\n    @keydown.up.stop.prevent=\"makeActivePrev()\"\n  >\n    <VaTimePickerColumnCell\n      v-for=\"(item, index) in items\" :key=\"item\"\n      @scroll.passive=\"onScroll\"\n      @touchmove.passive=\"onScroll\"\n      @mousewheel.passive=\"onScroll\"\n    >\n      <div\n        class=\"va-time-picker-cell\"\n        :class=\"{ 'va-time-picker-cell--active': index === $props.activeItemIndex }\"\n        @click=\"onCellClick(index)\"\n      >\n        <slot name=\"cell\" v-bind=\"{ item, index, activeItemIndex, items, formattedItem: formatCell(item) }\">\n          {{ formatCell(item) }}\n        </slot>\n      </div>\n    </VaTimePickerColumnCell>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport VaTimePickerColumnCell from '../VaTimePickerColumnCell.vue'\nimport { nextTick, shallowRef, watch, onMounted, PropType, computed, ComputedRef } from 'vue'\n\nimport { useSyncProp, useFocus, useFocusEmits, useTextColor, useNumericProp } from '../../../../composables'\nimport debounce from 'lodash/debounce.js'\n\ndefineOptions({\n  name: 'VaTimePickerColumn',\n})\n\nconst props = defineProps({\n  items: { type: Array as PropType<string[] | number[]>, default: () => [] },\n  activeItemIndex: { type: Number, default: 0 },\n  cellHeight: { type: [Number, String], default: 30 },\n})\n\nconst emit = defineEmits(['item-selected', 'update:activeItemIndex', ...useFocusEmits])\n\nconst rootElement = shallowRef<HTMLElement>()\nconst { focus, blur } = useFocus(rootElement, emit)\nconst [syncActiveItemIndex] = useSyncProp('activeItemIndex', props, emit)\n\nconst cellHeightComputed = useNumericProp('cellHeight') as ComputedRef<number>\n\nwatch(syncActiveItemIndex, (newVal) => { scrollTo(newVal) })\n\nonMounted(() => scrollTo(syncActiveItemIndex.value, false))\n\nconst scrollTo = (index: number, animated = true) => {\n  nextTick(() => {\n    // see: https://github.com/vuejs/vue-test-utils/issues/319#issuecomment-354667621\n    rootElement.value?.scrollTo?.({\n      behavior: animated ? 'smooth' : 'auto',\n      top: index * cellHeightComputed.value,\n    })\n  })\n}\n\nconst makeActiveByIndex = (index: number) => {\n  syncActiveItemIndex.value = index\n  nextTick(() => scrollTo(syncActiveItemIndex.value))\n}\n\nconst makeActiveNext = (times?: number) => {\n  syncActiveItemIndex.value = (syncActiveItemIndex.value + (times || 1)) % props.items.length\n  nextTick(() => scrollTo(syncActiveItemIndex.value))\n}\n\nconst makeActivePrev = (times?: number) => {\n  syncActiveItemIndex.value = (syncActiveItemIndex.value - (times || 1) + props.items.length) % props.items.length\n  nextTick(() => scrollTo(syncActiveItemIndex.value))\n}\n\nconst onCellClick = (index: number) => {\n  syncActiveItemIndex.value = index\n}\n\nconst formatCell = (n: number | string): string => {\n  if (!Number.isInteger(n)) { return n as string }\n\n  return Number(n) < 10 ? `0${n}` : `${n}`\n}\n\nconst getIndex = () => {\n  const scrollTop = rootElement.value!.scrollTop\n  const calculatedIndex = Math.max(\n    (scrollTop - scrollTop % cellHeightComputed.value) / cellHeightComputed.value,\n    scrollTop / cellHeightComputed.value,\n  )\n\n  if (calculatedIndex >= props.items.length) {\n    return props.items.length - 1\n  }\n  if (calculatedIndex < 0) {\n    return 0\n  }\n\n  if (syncActiveItemIndex.value * cellHeightComputed.value < scrollTop) {\n    return Math.ceil(calculatedIndex)\n  } else if (syncActiveItemIndex.value * cellHeightComputed.value > scrollTop) {\n    return Math.floor(calculatedIndex)\n  } else {\n    return Math.round(calculatedIndex)\n  }\n}\n\nconst onScroll = debounce(() => {\n  if (rootElement.value && syncActiveItemIndex.value !== -1) {\n    syncActiveItemIndex.value = getIndex()\n  }\n}, 200)\n\ndefineExpose({\n  focus,\n  blur,\n})\n</script>\n\n<style lang=\"scss\">\n@import 'variables';\n@import '../../../../styles/resources';\n\n@mixin hiddenYScroll {\n  overflow-y: scroll;\n  -ms-overflow-style: none;  /* IE and Edge */\n  scrollbar-width: none;  /* Firefox */\n  &::-webkit-scrollbar { /* WebKit */\n    display: none;\n  }\n}\n\n.va-time-picker-column {\n  @include hiddenYScroll();\n\n  color: currentColor;\n  height: 100%;\n  border-right: var(--va-time-picker-column-border-right);\n\n  &::before,\n  &::after {\n    content: \"\";\n    display: block;\n    height: var(--va-time-picker-column-gap-height);\n    width: 100%;\n  }\n\n  &:last-child {\n    border-right: 0;\n  }\n\n  .va-time-picker-cell {\n    height: var(--va-time-picker-cell-height);\n    line-height: var(--va-time-picker-cell-height);\n    width: var(--va-time-picker-cell-width);\n    text-align: center;\n    cursor: var(--va-time-picker-cell-cursor);\n    user-select: none;\n\n    &--active {\n      position: relative;\n      color: var(--va-time-picker-cell-active-color);\n      z-index: 0;\n\n      &::before {\n        background: var(--va-time-picker-cell-active-background);\n        position: absolute;\n        height: 100%;\n        width: 100%;\n        left: 0;\n        right: 0;\n        content: '';\n        z-index: -1;\n        opacity: var(--va-time-picker-cell-active-background-opacity);\n      }\n    }\n\n    &:hover {\n      background: var(--va-time-picker-cell-background-color-hover);\n    }\n  }\n\n  &:focus-visible {\n    outline: none;\n\n    .va-time-picker-cell {\n      &--active {\n        @include focus-outline($radius: 4px, $offset: -2px);\n      }\n    }\n  }\n}\n</style>\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;AAuCA,UAAM,QAAQ;AAMd,UAAM,OAAO;AAEb,UAAM,cAAc;AACpB,UAAM,EAAE,OAAO,KAAA,IAAS,SAAS,aAAa,IAAI;AAClD,UAAM,CAAC,mBAAmB,IAAI,YAAY,mBAAmB,OAAO,IAAI;AAElE,UAAA,qBAAqB,eAAe,YAAY;AAEhD,UAAA,qBAAqB,CAAC,WAAW;AAAE,eAAS,MAAM;AAAA,IAAA,CAAG;AAE3D,cAAU,MAAM,SAAS,oBAAoB,OAAO,KAAK,CAAC;AAE1D,UAAM,WAAW,CAAC,OAAe,WAAW,SAAS;AACnD,eAAS,MAAM;;AAEb,gCAAY,UAAZ,mBAAmB,aAAnB,4BAA8B;AAAA,UAC5B,UAAU,WAAW,WAAW;AAAA,UAChC,KAAK,QAAQ,mBAAmB;AAAA,QAAA;AAAA,MACjC,CACF;AAAA,IAAA;AAQG,UAAA,iBAAiB,CAAC,UAAmB;AACzC,0BAAoB,SAAS,oBAAoB,SAAS,SAAS,MAAM,MAAM,MAAM;AACrF,eAAS,MAAM,SAAS,oBAAoB,KAAK,CAAC;AAAA,IAAA;AAG9C,UAAA,iBAAiB,CAAC,UAAmB;AACrB,0BAAA,SAAS,oBAAoB,SAAS,SAAS,KAAK,MAAM,MAAM,UAAU,MAAM,MAAM;AAC1G,eAAS,MAAM,SAAS,oBAAoB,KAAK,CAAC;AAAA,IAAA;AAG9C,UAAA,cAAc,CAAC,UAAkB;AACrC,0BAAoB,QAAQ;AAAA,IAAA;AAGxB,UAAA,aAAa,CAAC,MAA+B;AACjD,UAAI,CAAC,OAAO,UAAU,CAAC,GAAG;AAAS,eAAA;AAAA,MAAY;AAExC,aAAA,OAAO,CAAC,IAAI,KAAK,IAAI,CAAC,KAAK,GAAG,CAAC;AAAA,IAAA;AAGxC,UAAM,WAAW,MAAM;AACf,YAAA,YAAY,YAAY,MAAO;AACrC,YAAM,kBAAkB,KAAK;AAAA,SAC1B,YAAY,YAAY,mBAAmB,SAAS,mBAAmB;AAAA,QACxE,YAAY,mBAAmB;AAAA,MAAA;AAG7B,UAAA,mBAAmB,MAAM,MAAM,QAAQ;AAClC,eAAA,MAAM,MAAM,SAAS;AAAA,MAC9B;AACA,UAAI,kBAAkB,GAAG;AAChB,eAAA;AAAA,MACT;AAEA,UAAI,oBAAoB,QAAQ,mBAAmB,QAAQ,WAAW;AAC7D,eAAA,KAAK,KAAK,eAAe;AAAA,MACvB,WAAA,oBAAoB,QAAQ,mBAAmB,QAAQ,WAAW;AACpE,eAAA,KAAK,MAAM,eAAe;AAAA,MAAA,OAC5B;AACE,eAAA,KAAK,MAAM,eAAe;AAAA,MACnC;AAAA,IAAA;AAGI,UAAA,WAAW,SAAS,MAAM;AAC9B,UAAI,YAAY,SAAS,oBAAoB,UAAU,IAAI;AACzD,4BAAoB,QAAQ;MAC9B;AAAA,OACC,GAAG;AAEO,aAAA;AAAA,MACX;AAAA,MACA;AAAA,IAAA,CACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}