{"version":3,"file":"VaCollapse.vue_vue_type_script_setup_true_lang.js","sources":["../../../../../src/components/va-collapse/VaCollapse.vue"],"sourcesContent":["<template>\n  <div class=\"va-collapse\" :class=\"computedClasses\">\n    <div\n      class=\"va-collapse__header-wrapper\"\n      @click=\"toggle\"\n      @keydown.enter=\"toggle\"\n      @keydown.space=\"toggle\"\n    >\n      <slot\n        name=\"header\"\n        v-bind=\"{\n          value: computedModelValue,\n          bind: headerAttributes,\n          attributes: headerAttributes,\n          attrs: headerAttributes,\n          iconAttrs: {\n            class: [\n              'va-collapse__expand-icon',\n              computedModelValue ? 'a-collapse__expand-icon--expanded' : 'a-collapse__expand-icon--collapsed'\n            ]\n          },\n          text: header,\n        }\"\n      >\n        <div\n          v-bind=\"headerAttributes\"\n          class=\"va-collapse__header\"\n          :style=\"headerStyle\"\n        >\n          <va-icon\n            v-if=\"icon\"\n            class=\"va-collapse__header__icon\"\n            :name=\"icon\"\n          />\n          <slot\n            name=\"header-content\"\n            v-bind=\"{ header }\"\n          >\n            <div class=\"va-collapse__header__text\">\n              {{ header }}\n            </div>\n          </slot>\n          <slot name=\"expand-icon\">\n            <va-icon\n              class=\"va-collapse__expand-icon\"\n              name=\"va-arrow-down\"\n              :class=\"computedModelValue ? 'va-collapse__expand-icon--expanded' : 'va-collapse__expand-icon--collapsed'\"\n            />\n          </slot>\n        </div>\n      </slot>\n    </div>\n    <div\n      class=\"va-collapse__body-wrapper\"\n      :class=\"{\n        'va-collapse__body-wrapper--bordered': !$slots.body && !$slots.header,\n      }\"\n      :style=\"contentStyle\"\n      @transitionend=\"onTransitionEnd\"\n    >\n      <div\n        v-if=\"doRenderBody\"\n        class=\"va-collapse__body\"\n        ref=\"body\"\n        role=\"region\"\n        :id=\"panelIdComputed\"\n        :aria-labelledby=\"headerIdComputed\"\n      >\n        <slot name=\"body\">\n          <div class=\"va-collapse__content\">\n            <slot name=\"default\">\n              <slot name=\"content\" />\n            </slot>\n          </div>\n        </slot>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, onMounted, ref, shallowRef, watch } from 'vue'\nimport pick from 'lodash/pick.js'\n\nimport {\n  useColors, useTextColor,\n  useBem,\n  useResizeObserver,\n  useComponentPresetProp,\n  useStateful,\n  useStatefulProps,\n  useSelectableEmits,\n} from '../../composables'\nimport { useAccordionItem } from '../va-accordion/hooks/useAccordion'\n\nimport { useComponentUuid } from '../../composables/useComponentUuid'\n\nimport { VaIcon } from '../va-icon'\nimport isNil from 'lodash/isNil'\n\ndefineOptions({\n  name: 'VaCollapse',\n})\n\nconst props = defineProps({\n  ...useComponentPresetProp,\n  ...useStatefulProps,\n  modelValue: { type: Boolean, default: false },\n  disabled: { type: Boolean, default: false },\n  header: { type: String, default: '' },\n  icon: { type: String, default: '' },\n  color: { type: String, default: undefined },\n  bodyColor: { type: String, default: undefined },\n  textColor: { type: String, default: '' },\n  bodyTextColor: { type: String, default: '' },\n  iconColor: { type: String, default: 'secondary' },\n  colorAll: { type: Boolean, default: false },\n  stateful: { type: Boolean, default: true },\n})\n\nconst emit = defineEmits(['update:modelValue', ...useSelectableEmits])\n\nconst body = shallowRef<HTMLElement>()\n\nconst { valueComputed } = useStateful(props, emit, 'modelValue')\n\nconst { getColor, getTextColor, setHSLAColor } = useColors()\nconst { accordionProps, accordionItemValue } = useAccordionItem()\n\nconst computedModelValue = computed({\n  get () {\n    // If user provided value directly on VaCollapse, we use it instead of accordion value\n    if (valueComputed.userProvided) {\n      return valueComputed.value\n    }\n\n    if (!isNil(accordionItemValue)) {\n      return accordionItemValue.value\n    }\n\n    return valueComputed.value\n  },\n  set (v) {\n    if (!isNil(accordionItemValue)) {\n      accordionItemValue.value = v\n    }\n    valueComputed.value = v\n  },\n})\n\nif (valueComputed.userProvided && !isNil(accordionItemValue)) {\n  accordionItemValue.value = valueComputed.value\n}\n\nconst bodyHeight = ref()\nuseResizeObserver([body], ([body]) => {\n  bodyHeight.value = body.contentRect.height ?? 0\n})\n\nconst height = computed(() => computedModelValue.value ? bodyHeight.value : 0)\n\nconst getTransition = () => {\n  const duration = height.value / 1000 * 0.2\n  return `${duration > 0.2 ? duration : 0.2}s`\n}\n\nconst contentBackground = computed(() => {\n  if (props.bodyColor) {\n    return getColor(props.bodyColor)\n  }\n\n  return props.color && props.colorAll\n    ? setHSLAColor(getColor(props.color), { a: 0.07 })\n    : undefined\n})\n\nconst headerBackground = computed(() => {\n  return props.color ? getColor(props.color) : undefined\n})\n\nconst uniqueId = useComponentUuid()\nconst headerIdComputed = computed(() => `header-${uniqueId}`)\nconst panelIdComputed = computed(() => `panel-${uniqueId}`)\nconst tabIndexComputed = computed(() => props.disabled ? -1 : 0)\n\nconst headerAttributes = computed(() => ({\n  id: headerIdComputed.value,\n  tabindex: tabIndexComputed.value,\n  'aria-controls': panelIdComputed.value,\n  'aria-expanded': computedModelValue.value,\n  'aria-disabled': props.disabled,\n  role: 'button',\n}))\n\nconst isHeightChanging = ref(false)\n\nwatch(height, (newValue, oldValue) => {\n  // If no transition happened, just got initial height value\n  if (oldValue === undefined) { return }\n  if (isHeightChanging.value === true) { return }\n  isHeightChanging.value = true\n})\n\nconst onTransitionEnd = (e: TransitionEvent) => {\n  if (e.propertyName === 'height' && e.target === e.currentTarget) {\n    isHeightChanging.value = false\n  }\n}\n\nconst computedClasses = useBem('va-collapse', () => ({\n  ...pick(props, ['disabled']),\n  expanded: computedModelValue.value,\n  active: computedModelValue.value,\n  popout: !!(accordionProps.value.popout && computedModelValue.value),\n  inset: !!(accordionProps.value.inset && computedModelValue.value),\n  'height-changing': isHeightChanging.value,\n  'colored-body': Boolean(contentBackground.value),\n  'colored-header': Boolean(headerBackground.value),\n}))\n\nconst toggle = () => {\n  if (props.disabled) { return }\n  computedModelValue.value = !computedModelValue.value\n}\n\nconst { textColorComputed } = useTextColor(headerBackground)\n\nconst headerStyle = computed(() => ({\n  color: textColorComputed.value,\n  backgroundColor: headerBackground.value,\n}))\n\n// Prevent body from rendering, to prevent tabbing into it\nconst doRenderBody = computed(() => {\n  if (computedModelValue.value) {\n    return true\n  }\n\n  if (isHeightChanging.value) {\n    return true\n  }\n\n  return false\n})\n\nconst contentStyle = computed(() => {\n  return {\n    height: `${height.value}px`,\n    transitionDuration: getTransition(),\n    background: computedModelValue.value ? contentBackground.value : '',\n    color: props.bodyTextColor\n      ? getColor(props.bodyTextColor)\n      : contentBackground.value\n        ? getColor(getTextColor(contentBackground.value))\n        : 'currentColor',\n  }\n})\n\ndefineExpose({\n  toggle,\n})\n</script>\n\n<style lang=\"scss\">\n@import \"../../styles/resources\";\n@import \"variables\";\n\n.va-collapse {\n  transition: var(--va-collapse-transition, var(--va-swing-transition));\n  font-family: var(--va-font-family);\n  display: flex;\n  flex-direction: column;\n\n  &__body-wrapper {\n    transition: var(--va-collapse-body-wrapper-transition);\n    overflow: auto;\n\n    &--bordered {\n      border-bottom: 1px solid var(--va-background-border);\n      box-sizing: content-box;\n\n      .va-collapse--colored-header:not(.va-collapse--expanded) & {\n        border-bottom: none;\n      }\n\n      .va-collapse--colored-body.va-collapse--expanded & {\n        border-bottom: none;\n      }\n    }\n  }\n\n  &__body {\n    top: 0;\n    left: 0;\n    width: var(--va-collapse-body-width);\n    transition: var(--va-collapse-body-transition);\n    opacity: 0;\n  }\n\n  &__content {\n    padding: var(--va-collapse-padding);\n    padding-top: calc(var(--va-collapse-padding) / 1.5);\n    box-sizing: border-box;\n\n    &:empty {\n      padding: 0;\n    }\n  }\n\n  &__header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    gap: var(--va-collapse-gap);\n    cursor: var(--va-collapse-header-content-cursor);\n    padding: var(--va-collapse-padding);\n    transition: all 0.2s ease-in-out;\n\n    &__text {\n      width: 100%;\n      font-weight: var(--va-collapse-header-content-text-font-weight);\n    }\n\n    @include keyboard-focus-outline(var(--va-collapse-header-content-border-radius));\n  }\n\n  &--expanded {\n    .va-collapse {\n      &__body {\n        opacity: 1;\n      }\n    }\n  }\n\n  &__expand-icon {\n    transition: var(--va-collapse-expand-icon-transition);\n\n    &--expanded {\n      transform: rotate(180deg);\n    }\n  }\n\n  &--popout {\n    margin: var(--va-collapse-popout-margin);\n  }\n\n  &--inset {\n    margin: var(--va-collapse-inset-margin);\n  }\n\n  &--disabled {\n    @include va-disabled();\n  }\n\n  &--height-changing {\n    .va-collapse {\n      &__body-wrapper {\n        overflow: hidden;\n      }\n    }\n  }\n}\n</style>\n"],"names":["body"],"mappings":"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"}